\documentclass[twocolumn]{jsarticle}
\usepackage[dvipdfmx]{graphicx}
\usepackage{kenzemi}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}


\begin{document}

\title{折り返し型ギルバート乗算回路の周波数特性劣化}
\author{小島 光}
\date{2023年10月2日}
\abstract{以前から検討している折り返し型ギルバート乗算回路について、非線形な動作をする乗算回路について小信号等価回路に手を加え解析を行った。またPMOSの各端子間にキャパシタを付加し、各回路について小信号解析を行った。}
\keyword{ギルバート乗算回路,小信号解析,非線形回路}
\maketitle

\section{はじめに}
以前設計した従来型との比較のために設計した折り返し型ギルバート乗算回路(図\refeq{fig:folded_gilbert})ではサイズの大きなPMOSを使用している。したがって、ゲート面積が増大し寄生容量が大きくなることが考えられる。今週はこの寄生容量について、具体的にどの部分が最も周波数特性劣化の原因として大きいのかを検討した。

\begin{figure}[h]
    \begin{center}
        \includegraphics*[width=80mm]{figures/folded_gilbert.png}
        \caption{検討している折り返し型ギルバート乗算回路}
        \label{fig:folded_gilbert}
    \end{center}
\end{figure}

\section{動作点の変動}

図\refeq{fig:folded_gilbert}ではPMOSFETのゲートに直流で$\pm V_{CTRL}$なる電圧を印加する。これはつまり、PMOSFETに流れるバイアス電流が$V_{CTRL}$により変動することを意味している。小信号解析では入力信号が小振幅であるとき、MOSFETのトランスコンダクタンス$g_{m}$が一定であるという近似を前提として小信号等価回路を作成する。しかし、トランスコンダクタンス$g_{m}$は実際には一定でなく、ドレイン電流$I_{D}$と定数係数$K$を用いて

\begin{align}
    g_{m}=2\sqrt{KI_{D}} \label{eq:gm}
\end{align}

と表される。即ち$V_{CTRL}$によりPMOSFETに流れるドレイン電流が変化すると、それに伴いトランスコンダクタンスが変化することになる。このままでは小信号解析を行うことができないので、まずは$V_{CTRL}$とトランスコンダクタンスの関係を明らかにする。\par
まずは片方のPMOS差動対について考えるが、今回のような対応する接点の電圧と電流の符号が反転するような回路において、対応する半分ののみを考えればもう半分については符号を入れ替えればよいので、片側のPMOS差動対のみについて解析すれば事足りる。したがって、図\refeq{fig:folded_gilbert}において左側のPMOS差動対を取り出し、図\refeq{fig:pmos_diff}のような回路について考える。

\begin{figure}[h]
    \begin{center}
        \includegraphics*[width=80mm]{figures/pmos_diff.png}
        \caption{PMOS差動対}
        \label{fig:pmos_diff}
    \end{center}
\end{figure}%

一般にMOSFETのドレイン電流は2乗則に従い

\begin{align}
    I_{D}=K(V_{GS}-V_{th})^{2}  \label{eq:square}
\end{align}

である。では、図\refeq{fig:pmos_diff}において$V_{CTRL}=0$のとき、ゲートソース間電圧は$V_{GS}=V_{pS}-V_{G}$なので、トランスコンダクタンスは

\begin{align}
    g_{mp} = \frac{\partial I_{D}}{\partial V_{GS}} &= \frac{\partial}{\partial V_{GS}} K(V_{GS}-V_{th})^{2} \notag\\
    &=2K(V_{GS}-V_{th})    \notag\\ 
    &=2K(V_{pS}-V_{G}-V_{th})   \label{eq:g_mp}
\end{align}

と計算できる。次に$V_{CTRL}\neq0$の時、$V_{GS}=V_{pS}- \left( V_{G}-V_{CTRL} \right)$なので左右のトランスコンダクタンスをそれぞれ$g_{mpl},g_{mpr}$とすると

\begin{align}
    g_{mpl} = \frac{\partial I_{D}}{\partial V_{GS}} &= \frac{\partial}{\partial }V_{GS} K(V_{GS}-V_{th})^{2} \notag\\
    &=2K(V_{GS}-V_{th})    \notag\\ 
    &=2K(V_{pS}-V_{G}+V_{CTRL}-V_{th})  \notag\\
    &=g_{mp}+2KV_{CTRL}\equiv g_{mp}+\Delta g_{m}   \label{eq:g_mpl}\\
    g_{mpr} = \frac{\partial I_{D}}{\partial V_{GS}} &= \frac{\partial}{\partial }V_{GS} K(V_{GS}-V_{th})^{2} \notag\\
    &=2K(V_{GS}-V_{th})    \notag\\ 
    &=2K(V_{pS}-V_{G}-V_{CTRL}-V_{th})  \notag\\
    &=g_{mp}-2KV_{CTRL}\equiv g_{mp}-\Delta g_{m}   \label{eq:g_mpr}\\
    \Delta g_{m}&=2KV_{CTRL}   \label{eq:delta_gm}
\end{align}

と表すことができた。従って$V_{CTRL}$が差動で印加されたとき、トランスコンダクタンスは$V_{CTRL}$に比例して変化することが分かった。

\section{解析結果の考察}
前回、各端子間に容量がついたときの出力の式を示したが、改めてゲートソース間、ソースゲート間、ゲートドレイン間に寄生容量がついた時の$v_{in}$を入力とする増幅率をを以下に示す。

\begin{align*}
    A_{SG}=\frac{2R_{L}g_{mn}}{ (1+2R_{L}g_{dp})(g_{mp}+j\omega C_{GS}) }\Delta g_{m}  \\
    A_{SD}=\frac{2R_{L}g_{mn}}{ (1+2R_{L}g_{dp})(g_{mp}+j\omega C_{SD}) }\Delta g_{m}  \\
    A_{GD}=\frac{2R_{L}g_{mn} }{ g_{mp}(1+2R_{L}g_{dp} + j2R_{L}\omega C_{GD}) }\Delta g_{m}  
\end{align*}

であった。ここで、前述の式\eqref{eq:delta_gm}を代入すると

\begin{align}
    A_{SG}=\frac{4KR_{L}g_{mn} }{ (1+2R_{L}g_{dp})(g_{mp}+j\omega C_{GS}) }\cdot V_{CTRL}  \label{eq:a_sg}\\
    A_{SD}=\frac{4KR_{L}g_{mn} }{ (1+2R_{L}g_{dp})(g_{mp}+j\omega C_{SD}) }\cdot V_{CTRL}  \label{eq:a_sd}\\
    A_{GD}=\frac{4KR_{L}g_{mn} }{ g_{mp}(1+2R_{L}g_{dp} + j2R_{L}\omega C_{GD}) }\cdot V_{CTRL}    \label{eq:a_gd}
\end{align}

したがって、各寄生容量がついた時の遮断周波数を$f_{SG},f_{SD},f_{GD}$とおくと

\begin{align}
    f_{SG} &= \frac{g_{mp}}{2\pi C_{SG}}    \label{eq:cutoff_sg}\\
    f_{SD} &= \frac{g_{mp}}{2\pi C_{SD}}    \label{eq:cutoff_sd}\\
    f_{GD} &= \frac{1+2R_{L}g_{dp}}{4\pi R_{L}C_{GD}}      \label{eq:cutoff_gd}
\end{align}

と計算できた。
    

\end{document}